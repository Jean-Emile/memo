<%inherit file="/base.html"/>

<%block name="content">

  <%include file='../menu.html'/>

  <section class="doc">

    <h1>Deploying your own personal cloud</h1>

    <p class="note">Personal cloud services like Dropbox, Hightail, Google Drive and the hundreds of clones provide a few gigabytes to store your files in the cloud and sync them between your devices.</p>

    <p class="note">Unfortunately, the storage capacity is often very limited for most users, in particular professionals while such services do not secure the files, leaving them unprotected from governments, business partners and hackers. Such services have many other limitations that prevent users from putting all their files in the same service and stop worrying.
    </p>

    <p>Infinit does without limitations, leaving to the user the choice to use local storage or not, which cloud services’ storage capacities to aggregate to form a virtually infinite drive and much more. Imagine storing all of your photos, videos and sensitive files, without having to worry about security and privacy, and all of that for free. Follow the guide!</p>

    <p>The following assumes you have downloaded and installed Infinit on your machine. If not, please refer to the <a href="#">Getting started</a> walkthrough.</p>

    <h2>Create a user</h2>

<pre>
$[device A]> infinit-user --create --name jacquo
Generating RSA keypair.
Generated user "jacquo".
$[device A]>
</pre>

    <p>By simply passing the --create option, Infinit takes care of generating a RSA key pair and creating a user whose name is based on your UNIX username. Please refer to the infinit-user manual or reference page for more options such as using your existing SSH RSA key.</p>

    <h2>Register your user on the hub</h2>

    <p>The Infinit hub allows for users to very easily manage their resources being networks and storages (in particular cloud-based) from any device without having to move configuration files around manually.</p>

    <p>To register an account based on your freshly created user, simply use the --register option. Note that you will need to choose a unique handle just as it is the case on Twitter, Github and many other services.</p>

<pre>
$[device A]> infinit-user --register --name jacquo --handle jrc --email jacques@chirac.fr
… XXX ...
$[device A]> </pre>

    <p>To simplify all the hub-related commands, you can set the INFINIT_HUB_HANDLE environment variable to your handle:</p>

<pre>
$[device A]> export INFINIT_HUB_HANDLE=”jrc”
$[device A]>
</pre>


    <h2>Plug your cloud services</h2>

    <p>Now that you have an account, plugging your cloud services to use as storage resources is going to be extremely simple.</p>

    <p>The infinit-credentials binary will be used for that purpose. The <span class="code">--add</span> option can be used to list all the cloud services that are supported at the moment.</p>

<pre>
$[device A]> infinit-credentials --add
</pre>

<pre>
Add credentials for a third-party service:

Add options:
  --user arg             user to manage credentials with (defaults to system
                         user)

Services:
  --dropbox              Dropbox account credentials
</pre>

    <p>At the moment, we only support a handful of cloud services but adding more is quite a simple process. If you feel like contributing, please do not hesitate to <a href="#">get in touch</a>.</p>

    <p>Let’s start by plugging your Dropbox account. Even though Dropbox already provides a file storage service, Infinit is going to use Dropbox’s storage capacity to store blocks of encrypted data.</p>

<pre>
$[device A]> infinit-credentials --handle jrc --add --dropbox
Register your dropbox account with infinit by visiting https://...
$[device A]></pre>

    <p>At this point you need to visit the URL displayed in your terminal. This will bring you to the Dropbox’s authentication page. Log in and authorize the Infinit application to add your Dropbox to the list of cloud storage resources that you will be able to plug to your Infinit file systems.</p>

    <p>Once you have authorized Dropbox to be used by Infinit, you should be redirected to the Infinit website.</p>

    <p>Now that you’ve plugged Dropbox, you can do the same with other cloud services or even other accounts, assuming you have multiple Dropbox accounts for instance.</p>

    <p class="note">Note that the cloud services have been added to your hub account. You need to fetch them locally to be able to plug them to your file systems.</p>

<pre>
$[device A]> infinit-credentials --list
Dropbox:
$[device A]> infinit-credentials --handle jrc --fetch
Fetched Dropbox account 455444556 (Jacques Chirac)
$[device A]> infinit-credentials --list
Dropbox:
  455444556: Jacques Chirac
$[device A]>
</pre>

    <p>That’s it, you have added your cloud services and they are ready to be used to store data.</p>


    <h2>Create storages on top of cloud services</h2>

    <p>This next step consists in creating a storage resource, through the infinit-storage binary, on one of the cloud service you’ve added.</p>

    <p>Let’s create a storage on the Dropbox account we’ve just added by specifying the account number listed through <span class="code">infinit-credentials --list</span>. Note that you also need to name this storage to manipulate it in the future e.g ‘dropbox’.</p>

<pre>
$[device A]> infinit-storage --create --dropbox --account 455444556 --name dropbox
Created storage "dropbox".
$[device A]> </pre>

    <p><strong>Important note:</strong> Infinit will store files in a subdirectory of your Dropbox. By default this subdirectory is <span class="code">.infinit/</span> but can be specified through the --root option. Never will Infinit erase or alter files already stored in your Dropbox.</p>

    <p>Once again, you can create storages on more than one Dropbox or other cloud services following the same process.</p>


    <h2>Create a network</h2>

    <p>Since this deployment involves a single user with multiple devices and one or more cloud services, creating and configuring the network is going to be very straightforward.</p>

    <p>The <span class="code">infinit-network</span> command is used to create the network, specifying a name for the network and the list of storages to plug. In the example below, only the storage ‘dropbox’ is used but you can obviously plug as many storages as you want, no matter their nature.</p>

<pre>
$[device A]> infinit-network --create --as jacquo --name clouds --storage dropbox
Created network "clouds".
$[device A]>
</pre>

    <p>You’ve just created your first network that for now consists of only one computer and two storages:</p>



    <h2>Create a logical volume in the network</h2>

    <p>The last step consists in create a logical volume, i.e a hierarchical system to store and access files, on top of a network.</p>

    <p>Volumes can be manipulated through the infinit-volume binary as shown next:</p>

<pre>
$[device A]> infinit-volume --create ---as jacquo --network clouds --name personal
Starting network ".../clouds".
Creating volume root blocks.
Created volume ".../personal".
$[device A]>
</pre>

    <p>That’s it, you’ve created a ‘personal’ volume i.e a file system whose blocks will be stored in the ‘clouds’ network which relies on the ‘dropbox’ and ‘google drive’ storages.</p>



    <h2>Mount the volume</h2>

    <p>From this point, you can mount the volume as a regular partition to store and access files from anywhere.</p>

<pre>
$[device A]> mkdir mnt/
$[device A]> infinit-volume --mount --as jacquo --name personal --async-writes --cache --mountpoint mnt/
Running network ".../clouds".
Running volume ".../personal".
[…]
</pre>

    <p>Note that this command does not return. You can make it run in the background if you prefer. To stop it, just hit <span class="code">CTRL^C</span>.</p>


    <h2>Access the volume on another device</h2>

    <p>Now that you have successfully mounted the volume on your machine, it could be interesting to access the same data on another device.</p>

    <p>Before moving on to the other devices, we need to make the resources we’ve created retrievable. The following commands publish the network and volume resources on the hub:</p>

<pre>
$[device A]> infinit-network --publish --name clouds --as jacquo
… XXX …
$[device A]> infinit-volume --publish --name personal --as jacquo
... XXX ...
</pre>

    <p>By doing this, you will be able to fetch the network and volume configurations on another of your devices.</p>

    <p>Finally, there is one other resource that also needs to be transmitted to the other device:  the user. However, given its critical nature, you do not want to put it on the cloud but rather to move it manually and securely as you would do with a SSH key.</p>

    <p>Let’s first export the user into a file. Note the <span class="code">--full</span> option that means that both the public and private parts of the user’s RSA key must be exported.</p>

<pre>
$[device A]> infinit-user --export --full --name jacquo > jacquo.user
WARNING: you are exporting the user "jacquo" including the private key
WARNING: anyone in possession of this information can impersonate that user
WARNING: if you mean to export your user for someone else, remove the --full flag
$[device A]>
</pre>

    <p>From that point, you are free to move the file <span class="code">jacquo.user</span> through the method of your choice such as SCP.</p>

    <p>Now let’s move to device B. First, you obviously need to download, install and configure the Infinit command-line tools on this new device. Please refer to the <a href="#">Getting Started</a> page for that.</p>

    <p>Once installed, let us import the <span class="code">jacquo.user</span> file to re-create the user on this device.</p>

<pre>
$[device B]> infinit-user --import --input jacquo.user
Imported user “jacquo”.
$[device B]>
</pre>

    <p>The next steps consist in fetching the resources that you previously published on the hub: networks and volumes.</p>

<pre>
$[device B]> infinit-network --fetch --name clouds --user jacquo
Fetched network ".../clouds".
$[device B]> infinit-volume --fetch --name personal --as jacquo
Fetched volume ".../personal".
$[device B]> </pre>

  <p>At this point, you could already mount the volume to access your files. In this configuration however, the storages (Dropbox and Google Drive) are only plugged to <span class="code">device A</span>, meaning that in order to retrieve blocks from those storages, <span class="code">device A</span> would need to be available at any time.</p>

  <p>This is why we are going to set up a little optimization that will remove the step of going through <span class="code">device A</span> leading to better performance and more availability. Note however that this is unnatural in Infinit’s architecture and is used only in this deployment where there are multiple devices belonging to the same user.</p>

  <p>First, let’s fetch the credentials to the cloud services from the hub and then re-create the associated storages:</p>

<pre>
$[device B]> infinit-credentials --fetch --as jacquo
Fetched Dropbox credentials 455444556 (Jacques Chirac)
$[device B]> infinit-storage --create --dropbox --account 455444556 --name dropbox
Created storage "dropbox".
$[device B]>
</pre>

    <p>Finally, you need to connect this device to the network you created on the first device, contributing storage resources to the whole. Note that in this case, due to the optimization above, the storages are shared rather than contributed.</p>

<pre>
$[device B]> infinit-network --join --name clouds --storage dropbox --as jacquo
Joined network ".../clouds".
$[device B]>
</pre>

    <p>The command above joins the current device to the network ‘clouds’ contributing the storages specified.</p>

    <p>Finally, the volume can be mounted on this device as show below:</p>

<pre>
$[device B]> mkdir mnt/
$[device B]> infinit-volume --mount --name personal --mountpoint mnt/ --as jacquo --async-writes
Running network ".../clouds".
Running volume ".../personal".
[…]
</pre>

    <p>That’s it, you’ve created a drive of virtually unlimited capacity by relying on cloud storage capacities to create your personal and secure drive.</p>

    <p>Check out the more advanced <a href="#">deployments</a> to create drives with your friends, within your business or else.</p>

  </section>


























</%block>
