#include <doughnut.grpc.pb.h>
#include <grpc++/grpc++.h>

int main(int argc, char** argv)
{
  // create the connection to the infinit kv grpc server
  auto chan = grpc::CreateChannel(argv[1], grpc::InsecureChannelCredentials());
  // instanciate the client stub whose code was autogenerated
  auto kv = Doughnut::NewStub(chan);

  {
    <%include file="/resources/scripts/value-store/cpp/MakeImmutableBlock" />
  }

  <%include file="/resources/scripts/value-store/cpp/MakeMutableBlock" />

  auto address = insert.block().address();

  <%include file="/resources/scripts/value-store/cpp/Fetch" />

  {
    char payload[] = "new data";

    <%include file="/resources/scripts/value-store/cpp/Update" />

    <%include file="/resources/scripts/value-store/cpp/Remove" />
  }
}
